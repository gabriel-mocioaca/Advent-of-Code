#include <bits/stdc++.h>

using namespace std;

ifstream in("12.txt");
ofstream out("out.txt");

string us, o, s;
char x;

unordered_map<string, char> m;

char ver(int x){
    string a = o.substr(x-2,5);
    return m[a];
}

int main(){
    in >> us >> us >> o;
    o = "...................." + o + "................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................";
    cout << o.size();

    while(!in.eof()){
        in >> s >> us >> x;
        m[s] = x;
    }

    for(int gen = 1; gen <= 1000; ++gen){
        out << gen << ' ';
        s = "..";
        for(int i = 2; i < o.size() - 2; ++i){
            s = s + ver(i);
        }
        s = s + "..";
        o = s;

        int sum = 0;
        for(int i = 20; i < o.size(); ++i){
            if(o[i] == '#')
                sum += i - 20;
        }
        out << sum << ' ' <<o <<'\n';
    }
}
